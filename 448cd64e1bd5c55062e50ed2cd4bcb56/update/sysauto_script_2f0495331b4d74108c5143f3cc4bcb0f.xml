<?xml version="1.0" encoding="UTF-8"?><record_update table="sysauto_script">
    <sysauto_script action="INSERT_OR_UPDATE">
        <active>true</active>
        <business_calendar/>
        <condition><![CDATA[var now = new GlideDateTime();
var day = now.getDayOfWeekLocalTime();

var answer = !(day == 6 || day == 7);

answer;]]></condition>
        <conditional>true</conditional>
        <entered_time/>
        <max_drift/>
        <name>Remind or Close Incident Conversions</name>
        <offset/>
        <offset_type>0</offset_type>
        <run_as display_value="">548c98a01be7a490346ffd951a4bcbfa</run_as>
        <run_as_tz/>
        <run_dayofmonth>1</run_dayofmonth>
        <run_dayofweek>1</run_dayofweek>
        <run_period/>
        <run_start>2021-07-06 14:19:09</run_start>
        <run_time>1970-01-01 12:00:00</run_time>
        <run_type>daily</run_type>
        <script><![CDATA[var convertGr = new GlideRecord('u_incident_to_request_conversion');
//Reminded less than 3 times, not already converted, and hasn't been updated for more than 1 day.
convertGr.addEncodedQuery('u_reminded<4^u_state!=Converted');
convertGr.query();
while (convertGr.hasNext()) {
    convertGr.next();
    var remindCount = convertGr.u_reminded + 1;
    convertGr.u_reminded = remindCount;

    if (remindCount >= 4) {
        convertGr.u_state = "Cancelled";
        var incGr = new GlideRecord('incident');
        incGr.get(convertGr.u_incident.sys_id);
        incGr.query();
        gs.eventQueue('NotifyConversionRequestCancel', convertGr, convertGr.u_caller.sys_id, '');
        if (incGr.next()) {
            incGr.state = 1;
            incGr.work_notes = 'Incident re-opened by conversion process, no response from client after 3 attempts.';
            incGr.update();
        }
    } else {
        //fire notification to remind client
        gs.eventQueue('NotifyConversionRequestReminder', convertGr, convertGr.u_caller.sys_id, '');
    }
    convertGr.update();
}]]></script>
        <sys_class_name>sysauto_script</sys_class_name>
        <sys_created_by>system</sys_created_by>
        <sys_created_on>2021-07-06 15:00:15</sys_created_on>
        <sys_id>2f0495331b4d74108c5143f3cc4bcb0f</sys_id>
        <sys_mod_count>8</sys_mod_count>
        <sys_name>Remind or Close Incident Conversions</sys_name>
        <sys_package display_value="Global" source="global">global</sys_package>
        <sys_policy/>
        <sys_scope display_value="Incident to Request Conversion">448cd64e1bd5c55062e50ed2cd4bcb56</sys_scope>
        <sys_update_name>sysauto_script_2f0495331b4d74108c5143f3cc4bcb0f</sys_update_name>
        <sys_updated_by>Terry.Lillo</sys_updated_by>
        <sys_updated_on>2022-01-28 22:30:56</sys_updated_on>
        <time_zone/>
        <upgrade_safe>false</upgrade_safe>
    </sysauto_script>
    <sys_claim action="INSERT_OR_UPDATE">
        <claim_owner_scope display_value="Incident to Request Conversion">448cd64e1bd5c55062e50ed2cd4bcb56</claim_owner_scope>
        <claim_timestamp>17ea2ccd2490000001</claim_timestamp>
        <metadata_update_name>sysauto_script_2f0495331b4d74108c5143f3cc4bcb0f</metadata_update_name>
        <previous_claim_app_version>1.0.0</previous_claim_app_version>
        <previous_claim_name>Incident to Request Conversion</previous_claim_name>
        <previous_claim_scope>448cd64e1bd5c55062e50ed2cd4bcb56</previous_claim_scope>
        <sys_created_by>Terry.Lillo</sys_created_by>
        <sys_created_on>2022-01-28 22:27:19</sys_created_on>
        <sys_id>b24b378a1b9945508c5143f3cc4bcbba</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>Terry.Lillo</sys_updated_by>
        <sys_updated_on>2022-01-28 22:27:19</sys_updated_on>
    </sys_claim>
</record_update>
